I need a MiniZinc scheduling model for my factory.
I'm uploading my data files. Please read them and create the model.

---

# My Factory: IP (Injection Phylon) Production

## What We Make
We make shoe soles called "Injection Phylon" or IP. These soles go to the
assembly line where they get attached to the shoe upper part.

## Our Equipment
We have IP machines. Each machine has two sides - I call them Left and Right.
Each side works independently, like two separate production lines sharing
one machine body.

Each side has 10 slots where we install molds. A mold is a metal tool that
shapes the foam into a specific shoe size. So each side can run up to 10
molds at the same time.

I have multiple machines available. I want to find out the minimum number
of machines I actually need to complete all orders.

## Our Shifts
We operate the factory with 3 shifts per day:
- Shift 1: Morning (8 hours = 480 minutes)
- Shift 2: Afternoon (8 hours = 480 minutes)
- Shift 3: Night (8 hours = 480 minutes)

---

# Our Products

Each product we make has three characteristics:
- Mold type (e.g., MS252801-1)
- Size (e.g., 6, 7, 8, 6T, 7T, 8T - "T" means half sizes like 6.5, 7.5)
- Color (e.g., BIP024_WHITE, BIP024_LTIRONORE, BIP024_SUMMITWHITE)

---

# What I Know (Given Information)

## Equipment Settings (Fixed)
- Sides per machine: 2 (Left, Right)
- Slots per side: 10
- Shifts per day: 3
- Minutes per shift: 480 minutes
- Color change cleaning time: 120 minutes
- Mold change time: 15 minutes per mold

## Lead Time
IP must be ready before assembly starts. I need a buffer of working days
between IP completion and assembly. This lead time is specified as 3 days.

## My Orders (See uploaded: demand.csv)
What I need to produce. Each row is one order:
- MOLD: mold type (e.g., MS252801-1)
- SIZE: shoe size (e.g., 6, 7, 8, 6T, 7T)
- COLOR: color code (e.g., BIP024_WHITE)
- QTY: quantity needed
- DUE_DATE: when assembly needs them (planned assembly date)

## My Mold Inventory (See uploaded: molds.csv)
Equipment I own. Each row is one mold-size combination:
- MOLD: mold type (e.g., MS252801-1)
- SIZE: shoe size this mold produces
- INVENTORY: how many physical molds I own for this size
- CT: cycle time in minutes per unit

## Working Calendar (See uploaded: working_dates.csv)
Our factory calendar showing which days we operate:
- THEDATE: date (YYYYMMDD format)
- HOLIDAY_YN: 'N' means working day, 'Y' means holiday (factory closed)

---

# When Can We Start Production?

IP production must finish before assembly. Count backward from each
DUE_DATE by the lead time (in working days, skipping holidays) to find
the latest day we can produce each order.

The planning horizon starts from the earliest possible production date.

---

# What I Need to Decide (Model finds these)

For each order:
- Which day to produce?
- Which shift (1, 2, or 3)?
- Which machine and side?
- How much quantity on that (day, shift, side)?

---

# Rules We Must Follow

**Rule 1: One color per side per shift**
If a side is making white soles this shift, everything on that side must
be white. No mixing colors. Other sides can run different colors, but
each side sticks to one color per shift.

**Rule 2: Cleaning time when changing colors**
Switching to a different color on a side takes 120 minutes of cleaning.
If a side did white in the morning and switches to black in the afternoon,
we lose 120 minutes of the afternoon shift for cleaning.

**Rule 3: Mold changes between shifts**
Mold changes only happen between shifts, not during a shift.
At the start of a shift, if the molds on a side are different from
the previous shift, we spend 15 minutes per mold to swap them before
production begins. Once a shift starts, the mold configuration is fixed.

Total changeover time = 15 minutes × number of molds changed.

**Rule 4: We only have so many molds**
Check the INVENTORY column - that's how many physical molds we own for
each size. If we only have 6 molds for size 8, we can't run more than
6 molds for size 8 at the same time across ALL sides of ALL machines.

**Rule 5: Only 10 slots per side**
Each side has 10 stations for molds. Can't fit more than 10 molds on
one side at a time.

**Rule 6: Finish all orders completely**
Every order must be made. No skipping, no partial deliveries.

**Rule 7: Meet deadlines**
All orders have the same DUE_DATE, so all products share the same deadline.
The deadline = DUE_DATE minus lead time (3 working days) = last shift of the planning horizon.
Simply set prod_deadline[p] = num_shifts for all products.

**Rule 8: Don't overwork a side**
Each shift is 480 minutes. Total production time plus setup time
cannot exceed this.

Setup times to subtract at the start of shift:
- 120 minutes if color changed from previous shift
- 15 minutes × (molds changed) from previous shift

Example: Previous shift had 5 molds, new shift needs 3 different molds.
Setup time = 3 × 15 = 45 minutes
Available for production = 480 - 45 = 435 minutes

---

# What I Want to Know

**I want the most compact production plan:**

1. First priority: Use the fewest machines possible
2. Second priority: Use the fewest shifts possible

Give me a tight, efficient schedule.